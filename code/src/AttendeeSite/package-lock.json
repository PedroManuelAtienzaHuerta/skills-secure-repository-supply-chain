const axios = require('axios');

// Configura el baseURL
const baseURL = 'https://example.com/api';
const instance = axios.create({
  baseURL: baseURL
});

// Agrega un interceptor de solicitud
instance.interceptors.request.use(config => {
  // Combina baseURL con la URL proporcionada por el usuario
  const fullURL = new URL(config.url, baseURL);

  // Verifica que la URL resultante comience con baseURL
  if (!fullURL.href.startsWith(baseURL)) {
    return Promise.reject(new Error('La URL resultante no comienza con el baseURL.'));
  }

  // Asigna la URL combinada de nuevo a la configuraciÃ³n
  config.url = fullURL.href;

  return config;
}, error => {
  return Promise.reject(error);
});

// Ejemplo de uso
instance.get('http://attacker.test/ejemplo')
  .then(response => {
    console.log(response.data);
  })
  .catch(error => {
    console.error(error.message);
  });
